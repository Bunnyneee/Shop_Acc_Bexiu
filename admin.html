<!-- admin.html -->
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đăng nhập Admin</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Quicksand', sans-serif;
      background-color: #fff0f5;
      padding: 2rem;
    }
    h1 {
      text-align: center;
      color: #ff66aa;
    }
    .hidden { display: none; }
    .login-box, .acc-form, .acc-list {
      background: #fff;
      padding: 1rem;
      border-radius: 12px;
      margin: 1rem auto;
      max-width: 600px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    input, select, textarea, button {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #ff66aa;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .acc-item {
      background: #ffe6f0;
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 12px;
    }
    .acc-item img {
      max-width: 100px;
      margin-right: 0.5rem;
    }
  </style>
</head>
<body>
  <h1>Trang Quản Trị</h1>

  <div class="login-box" id="loginBox">
    <h2>Đăng nhập Admin</h2>
    <input type="password" id="adminPass" placeholder="Nhập mật khẩu">
    <button onclick="loginAdmin()">Đăng nhập</button>
  </div>

  <div class="acc-form hidden" id="formBox">
    <h2>Thêm acc mới</h2>
    <label>Level: <input type="number" id="level"></label>
    <label>Rank: <input type="text" id="rank"></label>
    <label>Liên kết:
      <select id="link1">
        <option value="">-- Chọn liên kết 1 --</option>
        <option>Gmail</option>
        <option>Facebook</option>
        <option>Facebook Die</option>
        <option>Game Center</option>
      </select>
      <select id="link2">
        <option value="">-- Chọn liên kết 2 --</option>
        <option>Gmail</option>
        <option>Facebook</option>
        <option>Facebook Die</option>
        <option>Game Center</option>
      </select>
    </label>
    <label>Ảnh (tối đa 20 ảnh, tên file phải tồn tại trong images/):
      <textarea id="images" placeholder="Nhập tên file cách nhau bởi dấu xuống dòng"></textarea>
    </label>
    <button onclick="submitAcc()">Thêm acc</button>
  </div>

  <div class="acc-list hidden" id="listBox">
    <h2>Danh sách acc</h2>
    <div id="adminList"></div>
  </div>

  <script src="script.js"></script>
  <script>
    const ADMIN_PASSWORD = 'bexiu2025'; // 🔐 Mật khẩu admin ở đây

    function loginAdmin() {
      const input = document.getElementById('adminPass').value;
      if (input === ADMIN_PASSWORD) {
        document.getElementById('loginBox').style.display = 'none';
        document.getElementById('formBox').classList.remove('hidden');
        document.getElementById('listBox').classList.remove('hidden');
        loadAdminList();
      } else {
        alert('Sai mật khẩu!');
      }
    }

    async function submitAcc() {
      const level = +document.getElementById('level').value;
      const rank = document.getElementById('rank').value.trim();
      const link1 = document.getElementById('link1').value;
      const link2 = document.getElementById('link2').value;
      const imagesText = document.getElementById('images').value.trim();

      if (!level || !link1 || !imagesText) return alert('Vui lòng nhập đầy đủ thông tin!');
      const links = [link1];
      if (link2 && link2 !== link1) links.push(link2);

      const images = imagesText.split(/\n|\r/).map(img => `images/${img.trim()}`).filter(x => x);
      if (images.length > 20) return alert('Tối đa 20 ảnh!');

      const acc = { level, rank, links, images, sold: false };
      await addAcc(acc);
      alert('Đã thêm acc mới!');
      loadAdminList();
    }

    async function loadAdminList() {
      const { accs } = await loadAccs();
      const wrap = document.getElementById('adminList');
      wrap.innerHTML = '';

      accs.forEach(acc => {
        const div = document.createElement('div');
        div.className = 'acc-item';
        div.innerHTML = `
          <strong>ID #${acc.id}</strong><br>
          Level: ${acc.level} | Rank: ${acc.rank}<br>
          Liên kết: ${acc.links.join(', ')}<br>
          <img src="${acc.images[0]}" alt="img">
          <br>
          <button onclick="deleteAcc(${acc.id}).then(loadAdminList)">🗑 Xoá</button>
          <button onclick="markSold(${acc.id}).then(loadAdminList)">✅ Đánh dấu đã bán</button>
        `;
        wrap.appendChild(div);
      });
    }
  </script>
</body>
</html>
